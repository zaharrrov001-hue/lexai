# üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Workflows –≤ LexAI

## ‚úÖ Workflow —Å–æ–∑–¥–∞–Ω –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!

–°–æ–∑–¥–∞–Ω workflow `legalConsultationWorkflow` –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç workflow:

Workflow –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 4 —à–∞–≥–æ–≤:

1. **–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** (`searchStep`)
   - –ò—â–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–º—É –≤–æ–ø—Ä–æ—Å—É
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `webSearchTool`

2. **–ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (`analyzeDocumentsStep`)
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `documentAnalysisTool`

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞** (`processLegalQueryStep`)
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å —Å —É—á–µ—Ç–æ–º –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `legalQueryTool`

4. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞** (`formatResponseStep`)
   - –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ workflow:

### –ß–µ—Ä–µ–∑ Mastra Client:

```typescript
import { mastra } from "./mastra";

// –ü–æ–ª—É—á–∞–µ–º workflow
const workflow = mastra.getWorkflow("legalConsultationWorkflow");

// –°–æ–∑–¥–∞–µ–º run –∏ –∑–∞–ø—É—Å–∫–∞–µ–º
const run = await workflow.createRunAsync();

// –ó–∞–ø—É—Å–∫ —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
const result = await run.start({
  inputData: {
    question: "–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –∏–º–µ–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫ –ø—Ä–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏?",
    jurisdiction: "RU",
    documents: [
      {
        text: "–¢–µ–∫—Å—Ç —Ç—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞...",
      },
    ],
  },
});

console.log(result.result.response);
```

### –ß–µ—Ä–µ–∑ API (–ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è):

```bash
curl -X POST https://your-project.mastra.ai/api/workflows/legalConsultationWorkflow/run \
  -H "Content-Type: application/json" \
  -d '{
    "inputData": {
      "question": "–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –∏–º–µ–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫ –ø—Ä–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏?",
      "jurisdiction": "RU"
    }
  }'
```

### –°—Ç—Ä–∏–º–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

```typescript
const run = await workflow.createRunAsync();

const result = await run.stream({
  inputData: {
    question: "–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –∏–º–µ–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫ –ø—Ä–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏–∏?",
  },
});

// –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
for await (const chunk of result.fullStream) {
  console.log("–®–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω:", chunk);
}
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ workflow:

```
legalConsultationWorkflow
  ‚îú‚îÄ‚îÄ searchStep (–ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
  ‚îú‚îÄ‚îÄ analyzeDocumentsStep (–∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
  ‚îú‚îÄ‚îÄ processLegalQueryStep (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞)
  ‚îî‚îÄ‚îÄ formatResponseStep (—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞)
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ workflow:

### Input Schema:

```typescript
{
  question: string;           // –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å
  documents?: Array<{        // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    url?: string;
    text?: string;
  }>;
  jurisdiction?: string;      // –Æ—Ä–∏—Å–¥–∏–∫—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "RU")
}
```

### Output Schema:

```typescript
{
  response: {
    question: string;
    answer: string;
    sources: Array<{
      title: string;
      url: string;
    }>;
    relevantLaws?: string[];
    recommendations?: string[];
    riskLevel?: "low" | "medium" | "high";
    disclaimer: string;
  };
}
```

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å workflow vs agent:

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Workflow**, –∫–æ–≥–¥–∞:
- ‚úÖ –ù—É–∂–Ω–∞ —á–µ—Ç–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤
- ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–æ—Ç–æ–∫–æ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ + –ø–æ–∏—Å–∫ + –∞–Ω–∞–ª–∏–∑

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Agent**, –∫–æ–≥–¥–∞:
- ‚úÖ –ù—É–∂–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –ó–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π –∏ –≤—ã–±–æ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ù—É–∂–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- [Workflows Overview](https://mastra.ai/docs/workflows/overview)
- [Workflow State](https://mastra.ai/docs/workflows/workflow-state)
- [Control Flow](https://mastra.ai/docs/workflows/control-flow)
- [Suspend & Resume](https://mastra.ai/docs/workflows/suspend-resume)

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞:

Workflow –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `src/mastra/index.ts`:

```typescript
export const mastra = new Mastra({
  agents: {
    lexaiAgent,
  },
  workflows: {
    legalConsultationWorkflow, // ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
  },
  // ...
});
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Mastra Cloud:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Studio –≤ Mastra Cloud
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Workflows"
3. –í—ã–±–µ—Ä–∏—Ç–µ `legalConsultationWorkflow`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —à–∞–≥–æ–≤** - –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–∫–æ–Ω–æ–≤
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å state** - –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏
3. **–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É** - –≤–µ—Ç–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å agent** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å workflow –≤–Ω—É—Ç—Ä–∏ agent

---

**Workflow –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

